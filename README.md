![Workflow](flowchart.png)

## Basic Description

This repo contains an implementation of XML-PRIDE (e**X**treme **M**ulti-**L**abel classification based on dee**P**
lea**R**n**I**ng with **D**ense prop**E**rties
) that leverages the idea of subsampling examples from data to reduce the negative impact of training loss.
Specifically, leADS performs an iterative procedure to: (a)- constructing an acquisition model in an ensemble
framework; (b) subselect informative examples using an acquisition function (entropy, mutual information, variation
ratios, normalized propensity scored precision at k); and (c)- train on reduced selected examples. The ensemble approach
was sought to enhance the generalization ability of the multi-label learning systems by concurrently building and
executing a group of multi-label base learners, where each is assigned a portion of samples, to ensure proper learning
of class labels (e.g. pathways). leADS was evaluated on the pathway prediction task using 10 multi-organism pathway
datasets, where the experiments revealed that leADS achieved very compelling and competitive performances against the
state-of-the-art pathway inference algorithms.

#### Code Description

This code trains a generative adversarial network to generate patient records. This work currently can handle patient
records that are aggregated over time, hence represented as a matrix where a row corresponds to a patient, and a column
to a specific medical code (e.g. diagonsis code, medication code, or procedure code). The value of the matrix could
either be binary (i.e. a specific medical code occurred in the longitudinal patient record or not) or count (i.e. how
many times a specific medical code occurred in the longitudinal patient record).

#### Running GRAM

**STEP 1: Installation**

1. medGAN was implemented to run on [TensorFlow](https://www.python.org/) 1.2. TensorFlow can be easily installed in
   Ubuntu as suggested [here](https://www.tensorflow.org/install/install_linux)

2. Download/clone the medGAN code

**STEP 2: Fast way to test medGAN with MIMIC-III**  
This step describes how to train medGAN, with minimum number of steps using MIMIC-III.

0. You will first need to request access for [MIMIC-III](https://mimic.physionet.org/gettingstarted/access/), a publicly
   avaiable electronic health records collected from ICU patients over 11 years.

1. You can use "process_mimic.py" to process MIMIC-III dataset and generate a suitable training dataset for medGAN.
   Place the script to the same location where the MIMIC-III CSV files are located, and run the script. The execution
   command is `python process_mimic.py ADMISSIONS.csv DIAGNOSES_ICD.csv <output file> <"binary"|"count">`. Note that the
   last argument decides whether you construct a binary matrix or a count matrix. The above command will extract ICD9
   diagnosis codes from MIMIC-III. Mind that this script will use only 3 digits of the ICD9 diagnosis code. If you want
   to use all 5 digits, please see the source code of "process_mimic.py".

2. Run medGAN using the ".matrix" file generated by process_mimic.py. The command is:
   `python medgan.py <matrix file> <output path> --data_type=["binary", "count"]`.

3. After the training, if you want to generate synthetic records, use this command :
   `python medgan.py <matrix file> <generated output path> --model_file=<trained output path> --generate_data=True`.
   Note that `<matrix file>` is not actually used for generating synthetic records, so it is just a dummy input.

## Citing
If you find *straSplit* useful in your research, please consider citing the following paper:
- M. A. Basher, Abdur Rahman, McLaughlin, Ryan J., and Hallam, Steven J.. **["Metabolic pathway inference using multi-label classification with rich pathway features."](https://doi.org/10.1371/journal.pcbi.1008174)**, PLoS Comput Biol (2020).
- M. A. Basher, Abdur Rahman and Hallam, Steven J.. **["Multi-label pathway prediction based on active dataset subsampling."](https://www.biorxiv.org/content/10.1101/2020.09.14.297424v1)**, bioRxiv (2020).
- M. A. Basher, Abdur Rahman. **["Machine learning methods for metabolic pathway inference from genomic sequence information."](https://open.library.ubc.ca/cIRcle/collections/ubctheses/24/items/1.0394748)**, Doctoral dissertation, University of British Columbia, (2020).
- Moyano, J.M., Gibaja, E.L. and Ventura, S.. **["MLDA: A tool for analyzing multi-label datasets."](https://www.sciencedirect.com/science/article/abs/pii/S0950705117300308)**, Knowledge-Based Systems (2017).
- Merrillees, M. and Du, L.. **["Stratified sampling for extreme multi-label data."](https://arxiv.org/abs/2103.03494)**,  arXiv preprint (2021).
- Sechidis, K., Tsoumakas, G. and Vlahavas, I.. **["On the stratification of multi-label data."](https://link.springer.com/chapter/10.1007/978-3-642-23808-6_10)**, In Joint European Conference on Machine Learning and Knowledge Discovery in Databases (pp. 145-158). Springer, Berlin, Heidelberg (2011).

## Contact
For any inquiries, please contact: [arbasher@student.ubc.ca](mailto:arbasher@student.ubc.ca)